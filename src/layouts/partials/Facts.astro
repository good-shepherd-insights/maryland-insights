---
import ImageMod from "@/components/ImageMod.astro";
import { markdownify } from "@/lib/utils/textConverter";
import type { CollectionEntry } from "astro:content";

type Props = {
  data: CollectionEntry<"homepage">["data"]["facts_section"];
  enableAnimation?: boolean;
};

const { data, enableAnimation = true } = Astro.props as Props;
if (!data.enable) return null;
const { pathname } = Astro.url;
---

<section class="border-y border-border bg-light">
  <div class="container">
    <div class="grid md:grid-cols-2 lg:grid-cols-4">
      {
        data.facts?.slice(0, 4).map((fact, i) => (
          <div
            class={`p-8 xl:p-10 group max-lg:text-center ${
              i === 0
                ? ""
                : [
                    // mobile: stacked items
                    "border-t border-border",
                    // md: 2 columns -> vertical divider only between the two columns
                    i % 2 === 1 ? "md:border-l md:border-border" : "",
                    // md: top divider only for second row
                    i < 2 ? "md:border-t-0" : "",
                    // lg: 4 columns -> only vertical dividers
                    "lg:border-t-0",
                    i > 0 ? "lg:border-l lg:border-border" : "",
                  ]
                    .filter(Boolean)
                    .join(" ")
            }`}
          >
            {/* Number Animation */}
            {pathname == "/" && (
              <div
               
               
                class="flex h-6 w-6 overflow-hidden items-center justify-center mb-16 max-lg:mx-auto border-b border-border"
              >
                <div class="h-6 w-6 transition duration-500 ease-out group-hover:-translate-y-full flex flex-col items-center text-text-light font-semibold">
                  <div class="min-w-6 flex justify-center items-center min-h-6">
                    <p class="text-lg">{i + 1 < 10 ? `0${i + 1}` : i + 1}</p>
                  </div>
                  <div
                    class="min-w-6 flex justify-center items-center min-h-6"
                    aria-hidden="true"
                  >
                    <p class="text-lg">{i + 1 < 10 ? `0${i + 1}` : i + 1}</p>
                  </div>
                </div>
              </div>
            )}

            <div>
              {enableAnimation ? (
                <div class="mb-8 w-12 h-12 overflow-hidden max-lg:mx-auto">
                  <div class="w-12 h-24 transition duration-500 ease-out group-hover:-translate-y-12 flex flex-col">
                    <div class="w-12 h-12 flex items-center justify-center">
                      <ImageMod
                        src={fact.icon}
                        width={48}
                        height={48}
                        alt={fact.label}
                      />
                    </div>
                    <div
                      class="w-12 h-12 flex items-center justify-center"
                      aria-hidden="true"
                    >
                      <ImageMod
                        src={fact.icon}
                        width={48}
                        height={48}
                        alt=""
                        aria-hidden="true"
                      />
                    </div>
                  </div>
                </div>
              ) : (
                <div class="mb-8 w-12 h-12 max-lg:mx-auto flex items-center justify-center">
                  <ImageMod
                    src={fact.icon}
                    width={48}
                    height={48}
                    alt={fact.label}
                  />
                </div>
              )}

              <h6
                class="h5 font-normal mb-2"
                set:html={markdownify(fact.label)}
              />
              <p class=" text-sm" set:html={markdownify(fact.description)} />
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
