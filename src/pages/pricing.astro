---
import PricingTable from "@/components/PricingTable.astro";
import PricingTableMobile from "@/components/PricingTableMobile.astro";
import Base from "@/layouts/Base.astro";
import { getListPage } from "@/lib/contentParser.astro";
import { markdownify } from "@/lib/utils/textConverter";
import CallToAction from "@/partials/CallToAction.astro";
import PageHeader from "@/partials/PageHeader.astro";
import PricingGrid from "@/partials/PricingGrid.astro";
import Testimonial from "@/partials/Testimonial.astro";

const pageIndex = await getListPage("pricing", "-index");
if (pageIndex.data.draft) return Astro.redirect("/404");

const { title, description, comparison_section } = pageIndex.data;
---

<Base {...pageIndex.data}>
  <PageHeader title={title} description={description} />
  <PricingGrid background="bg-light" />
  <!-- Compare Pricing Plans -->
  {
    comparison_section.enable && (
      <section class="section">
        <div class="container xl:w-[70%] mx-auto">
          <h2
            class="mb-12 text-center text-balance"
            data-aos="fade-up-sm"
            data-aos-delay="150"
            set:html={markdownify(comparison_section.title)}
          />

          {/* Pricing Plan Comparison Table  */}
          <PricingTable
            features={comparison_section.comparison_table.features}
            planNames={comparison_section.plan_names}
          />
          <PricingTableMobile
            features={comparison_section.comparison_table.features}
            planNames={comparison_section.plan_names}
          />
        </div>
      </section>
    )
  }
  <Testimonial />
  <CallToAction />
</Base>
